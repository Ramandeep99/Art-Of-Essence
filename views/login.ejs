<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LogIn/SignUp</title>

    <link rel="icon" type="image/png" href="https://cdn4.iconfinder.com/data/icons/photo-6/500/142-512.png">

    <!--<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">-->
    <link rel="stylesheet" href="/css/login.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Darker+Grotesque:wght@700&family=Josefin+Slab:wght@500&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!--Font Awesome-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/js/all.min.js" integrity="sha512-RXf+QSDCUQs5uwRKaDoXt55jygZZm2V++WUZduaU/Ui/9EGp3f/2KZVahFZBKGH0s774sd3HmrhUy+SgOFQLVQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>

    <div class="full-box">
        <div class="div left" id="slideshow">
            <div>
                <img src="/images/slide2.jpg" alt="">
            </div>
            <div>
                <img src="/images/slide3.jpg" alt="">
            </div>
            <div>
                <img src="/images/slide4.jpg" alt="">
            </div>
            <div>
                <img src="/images/log.jpg" alt="">
            </div>
        </div>
        <div class="div right">
            <div class="heading">
                <h1 class="heading-title">
                    Workspaces 
                    <br>
                    you'll love</h1>
                <h2 id="para">Instant access to thousands of coworking spaces nationwide for one monthly price.</h2>
            </div>
            <div class="login-container">
                <!-- <ul class="top-area">
                    <li class="tab active"><a href="#signup">Sign Up</a></li>
                    <li class="tab"><a href="#login">Log In</a></li>
               </ul> -->
                <div class="form">
                     <ul class="top-area">
                          <li class="tab active "><a href="#signup">Sign Up</a></li>
                          <li class="tab "><a href="#login">Log In</a></li>
                    </ul> 
                    <div class="tab-content">
                          <div id="signup">   
                            <h1 class="sign-title">Sign Up for Free!</h1>
                            <form id="form1">
                                <div class="form-control">
                                    <input type="text" name="name" required>
                                    <label>Full Name</label>
                                </div>
                              <div class="form-control">
                                <input type="text" name="email" required>
                                <label>Email</label>
                              </div>
                              <div class="form-control">
                                <input type="password" name="password" required>
                                <label>Password</label>
                                <span id="passwordError"></span>
                              </div>

                              <div class="form-control">
                                <input type="password" name="confirm_password" required>
                                <label>Confirm Password</label>
                              </div>
                                <div style="display: none;">
                                  <input type="radio" id="user" name="drone" value="user" checked>
                                  <label for="dewey">User</label>
                                </div>
                              
                                <button class="btn" type="submit">Sign Up</button>
                            </form>
                            
                         </div>
                      
                      <div id="login">   
                            <h1 class="sign-title">Welcome Back!</h1>
                        <form id="form2" class="signIn">
                              <div class="form-control">
                                  <input type="text" name="email" required>
                                  <label>Email</label>
                              </div>
                              <div class="form-control">
                                  <input type="password" name="password" required>
                                  <label>Password</label>
                              </div>
                              
                            <button class="btn" type="submit">Log In</button>
                                
                          </form>
                      </div>
                    </div>
                </div>
                <div id="google-login">
                    <div id="google">
                        <a href="/auth/google"><i class="fab fa-google"></i>Login with Google</a>
                    </div>

                    <div id="facebook">
                        <a href="/auth/google"><i class="fab fa-facebook-f"></i>Login with Facebook</a>
                    </div>
                </div>

            </div>
            
        </div>
    </div>
    <!----- JQUERY ----->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/1.18.0/TweenMax.min.js"></script>
    <!----BOOTSTAP---->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns" crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/js/bootstrap.min.js" integrity="sha384-oesi62hOLfzrys4LxRF63OJCXdXDipiYWBnvTl9Y9/TRlw5xlKIEHpNyvvDShgf/" crossorigin="anonymous"></script>


    <script>

        //----------Form Wave Animation------
        const labels = document.querySelectorAll('.form-control label');
        labels.forEach(label =>{
        label.innerHTML = label.innerText.split('').map((letter, idx) => 
         `<span style="transition-delay:${idx * 50}ms">${letter}</span>`).join('')
        });


        //------Slideshow------
        $("#slideshow > div:gt(0)").hide();

        setInterval(function() {
        $('#slideshow > div:first')
        .fadeOut(1000)
        .next()
        .fadeIn(1000)
        .end()
        .appendTo('#slideshow');
        }, 1900);


        //-------Button------
        // var $button = document.querySelector('.button');
        // $button.addEventListener('click', function() {
        // var duration = 0.3,
        // delay = 0.08;
        // TweenMax.to($button, duration, {scaleY: 1.6, ease: Expo.easeOut});
        // TweenMax.to($button, duration, {scaleX: 1.2, scaleY: 1, ease: Back.easeOut, easeParams: [3], delay: delay});
        // TweenMax.to($button, duration * 1.25, {scaleX: 1, scaleY: 1, ease: Back.easeOut, easeParams: [6], delay: delay * 3 });
        // });
        
        //toggle b/w login signup
        $('.form').find('input, textarea').on('keyup blur focus', function (e) {
  
  var $this = $(this),
      label = $this.prev('label');
 
   if (e.type === 'keyup') {
 if ($this.val() === '') {
          label.removeClass('active highlight');
        } else {
          label.addClass('active highlight');
        }
    } else if (e.type === 'blur') {
     if( $this.val() === '' ) {
     label.removeClass('active highlight'); 
 } else {
     label.removeClass('highlight');   
 }   
    } else if (e.type === 'focus') {
      
      if( $this.val() === '' ) {
     label.removeClass('highlight'); 
 } 
      else if( $this.val() !== '' ) {
     label.addClass('highlight');
 }
    }
 
});
 
$('.tab a').on('click', function (e) {
  
  e.preventDefault();
  
  $(this).parent().addClass('active');
  $(this).parent().siblings().removeClass('active');
  
  target = $(this).attr('href');
 
  $('.tab-content > div').not(target).hide();
  
  $(target).fadeIn(600);
  
});



// for request handling

// register form

            const formFields = document.querySelector('#form1');

            const email_error = document.getElementById('emailError');
            const password_error = document.getElementById('passwordError');
            

            formFields.addEventListener('submit', async (e) => {
                e.preventDefault();

                // get values 
                const name = formFields.name.value
                const email = formFields.email.value;
                const password = formFields.password.value;
                const confirm_password = formFields.confirm_password.value
                // const artistCheck = document.getElementById('artist').checked
                const userCheck = document.getElementById('user').checked
                console.log(userCheck)
                // console.log(name , email, password , confirm_password , artistCheck , userCheck)
                if(userCheck){
                  try {
                    // console.log(1999)
                    const res = await fetch('/register', {
                        method: "POST",
                        body: JSON.stringify({
                          name,
                            email,
                            password,
                            confirm_password
                        }),
                        headers: {
                            "Content-Type":  'application/json'
                        }
                    })

                    const data = await res.json();
                  
                        if (data.registered) {
                            location.assign('/login');
                        }
                    } catch (err) {
                        console.log(err);
                    }

                    }
              else{
                try {
                    const res = await fetch('/register', {
                        method: "POST",
                        body: JSON.stringify({
                          name,
                            email,
                            password,
                            confirm_password
                        }),
                        headers: {
                            "Content-Type":  'application/json'
                        }
                    });

                    const data = await res.json();
                    console.log(data)
                    // // console.log(data['email']);
                    // if (data['email']) {
                    //     email_error.innerHTML = '<div class="alert alert-warning">Please enter valid email id.</div>';
                    //     setTimeout(() => {
                    //         email_error.innerHTML = '';
                    //     }, 3000)
                    // }

                    // if (data.password) {
                    //     password_error.innerHTML = '<div class="alert alert-warning">Please enter correct password.</div>';
                    //     setTimeout(() => {
                    //         password_error.innerHTML = '';
                    //     }, 3000)

                    // }
                    //         if (data.userData) {
                    //             location.assign('/home');
                    //         }
                        } catch (err) {
                            console.log(err);
                        }

              }


                
            })

    // login form
    const formFields2 = document.querySelector('#form2');


        formFields2.addEventListener('submit', async (e) => {
            e.preventDefault();

            // get values 
            const email = formFields2.email.value;
            const password = formFields2.password.value;
     
            // console.log(email, password )

            try {
                console.log('request sent from frontend')
                const res = await fetch('/login', {
                    method: "POST",
                    body: JSON.stringify({
                    name,
                        email,
                        password
                    }),
                    headers: {
                        "Content-Type":  'application/json'
                    }
                })

                const data = await res.json;
                console.log(data)
                // // console.log(data['email']);
                // if (data['email']) {
                //     email_error.innerHTML = '<div class="alert alert-warning">Please enter valid email id.</div>';
                //     setTimeout(() => {
                //         email_error.innerHTML = '';
                //     }, 3000)
                // }

                // if (data.password) {
                //     password_error.innerHTML = '<div class="alert alert-warning">Please enter correct password.</div>';
                //     setTimeout(() => {
                //         password_error.innerHTML = '';
                //     }, 3000)

                // }
                if (data) {
                    location.assign('/');
                }
                } catch (err) {
                    console.log(err);
                }

        })



    </script>
</body>
</html>